<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.geometry.Insets?>

<VBox xmlns:fx="http://javafx.com/fxml"
      fx:controller="tn.finhub.controller.CreateEscrowController"
      spacing="20" styleClass="escrow-dialog"
      prefWidth="500">

    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="15">
        <StackPane style="-fx-background-color: -color-primary-light; -fx-padding: 10; -fx-background-radius: 50;">
            <SVGPath content="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" style="-fx-fill: -color-primary;" scaleX="1.2" scaleY="1.2"/>
        </StackPane>
        <VBox>
            <Label text="New Secure Escrow" styleClass="header-text" style="-fx-font-size: 20px;"/>
            <Label text="Funds are locked until you authorize release." styleClass="sub-header-text" style="-fx-font-size: 12px;"/>
        </VBox>
    </HBox>

    <Separator/>

    <!-- Form Fields -->
    <VBox spacing="15">
        
        <!-- Recipient -->
        <VBox spacing="5">
            <Label text="Seller Information (Recipient)" style="-fx-font-weight: bold; -fx-text-fill: -color-text-primary;"/>
            <TextField fx:id="recipientEmailField" promptText="Enter Seller's Email Address" styleClass="text-field-modern"/>
            <Label text="We will verify this user exists." style="-fx-text-fill: -color-text-muted; -fx-font-size: 10px;"/>
        </VBox>

        <!-- Amount & Type -->
        <HBox spacing="15">
            <VBox spacing="5" HBox.hgrow="ALWAYS">
                <Label text="Amount (TND)" style="-fx-font-weight: bold; -fx-text-fill: -color-text-primary;"/>
                <TextField fx:id="amountField" promptText="0.000" styleClass="text-field-modern"/>
            </VBox>
            <VBox spacing="5" HBox.hgrow="ALWAYS">
                <Label text="Release Method" style="-fx-font-weight: bold; -fx-text-fill: -color-text-primary;"/>
                <ComboBox fx:id="typeComboBox" maxWidth="Infinity" styleClass="combo-box-modern"/>
            </VBox>
        </HBox>

        <!-- Condition -->
        <VBox spacing="5">
             <Label text="Agreed Condition" style="-fx-font-weight: bold; -fx-text-fill: -color-text-primary;"/>
             <TextArea fx:id="conditionField" promptText="e.g. Delivery of iPhone 15 Pro Max, sealed box." prefRowCount="3" styleClass="text-area-modern" wrapText="true"/>
        </VBox>

        <!-- Fee Summary Box -->
        <VBox style="-fx-background-color: -color-card-bg; -fx-padding: 15; -fx-background-radius: 8; -fx-border-color: -color-border; -fx-border-radius: 8;">
            <HBox>
                <Label text="Subtotal" style="-fx-text-fill: -color-text-secondary;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="subtotalLabel" text="0.000 TND" style="-fx-text-fill: -color-text-primary;"/>
            </HBox>
            <HBox>
                <Label text="Service Fee (1%)" style="-fx-text-fill: -color-text-secondary;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="feeLabel" text="0.000 TND" style="-fx-text-fill: -color-text-secondary;"/>
            </HBox>
            <Separator style="-fx-padding: 10 0;"/>
            <HBox>
                <Label text="Total to Lock" style="-fx-font-weight: bold; -fx-text-fill: -color-text-primary;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="totalLabel" text="0.000 TND" style="-fx-font-weight: bold; -fx-text-fill: -color-primary; -fx-font-size: 14px;"/>
            </HBox>
        </VBox>

    </VBox>

    <HBox spacing="10" alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
        <Button text="Cancel" onAction="#handleCancel" styleClass="button-outlined"/>
        <Button text="Create &amp; Lock Funds" onAction="#handleCreate" styleClass="button-primary"/>
    </HBox>

</VBox>
